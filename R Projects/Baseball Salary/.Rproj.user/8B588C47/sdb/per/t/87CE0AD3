{
    "contents" : "# \n# playerID       Player ID code\n# yearID         Year\n# stint          player's stint (order of appearances within a season)\n# teamID         Team\n# lgID           League\n# G              Games\n# G_batting      Game as batter\n# AB             At Bats\n# R              Runs - Team\n# H              Hits\n# 2B             Doubles\n# 3B             Triples\n# HR             Homeruns - Ind\n# RBI            Runs Batted In\n# SB             Stolen Bases\n# CS             Caught Stealing\n# BB             Base on Balls\n# SO             Strikeouts\n# IBB            Intentional walks\n# HBP            Hit by pitch\n# SH             Sacrifice hits\n# SF             Sacrifice flies\n# GIDP           Grounded into double plays\n# G_Old          Old version of games (deprecated)\n\nb2011 <- read.csv('/users/alexandersedgwick/dropbox/development/ga/Ongoing Projects/baseball/baseball_training_2011.csv')\nb2012 <- read.csv('/users/alexandersedgwick/dropbox/development/ga/Ongoing Projects/baseball/baseball_test_2012.csv')\n\ntrain_X <- subset(b2011, select=-c(salary))\ntrain_y <- b2011['salary']\n\n#test_X = b2012[c('G', 'AB', 'R', 'H', 'X2B', 'X3B', 'HR', 'RBI', 'SB', 'CS', 'BB', 'SO', 'IBB', 'HBP', 'SH', 'SF')]\ntest_X <- subset(b2012, select=-c(salary))\nb2012_csv = b2012[c('playerID','yearID','salary')]\n\n#Inital Model\n\nfit = lm(salary ~ G+ AB + R + H + X2B + X3B + HR + RBI + SB + CS + BB + SO + IBB + HBP + SH + SF,b2011)\nsummary(fit)\nanova(fit)\nanova(fit)[[\"Mean Sq\"]] \n\nMSE = (summary(fit)$sigma)^2\n\n\n# diagnostic plots \nlayout(matrix(c(1,2,3,4),2,2)) # optional 4 graphs/page \nplot(fit)\n\n\n# Stepwise Regression\nlibrary(MASS)\nstep <- stepAIC(fit, direction=\"both\")\nstep$anova # display results\n\nstr(step)\n\n# All Subsets Regression\nlibrary(leaps)\n#ttach(mydata)\nleaps<-regsubsets(salary ~ G+ AB + R + H + X2B + X3B + HR + RBI + SB + CS + BB + SO + IBB + HBP + SH + SF,data=b2011,nbest=10)\n# view results \nsummary(leaps)\n# plot a table of models showing variables in each model.\n# models are ordered by the selection statistic.\nplot(leaps,scale=\"r2\")\nplot(leaps)\n# plot statistic by subset size \nlibrary(car)\nsubsets(leaps, statistic=\"rsq\")\n\n\n\n\nsalary ~ G + AB + R + H + X2B + X3B + RBI + CS + SO + IBB\n\n\nfit = lm(salary ~ G+ AB + R + H + X2B + X3B + HR + RBI + SB + CS + BB + SO + IBB + HBP + SH + SF,b2011)\nfit2 = lm(salary ~ G + AB + R + H + X2B + X3B + RBI + CS + SO + IBB,b2011)\nsummary(fit)\nsummary(fit2)\n\nanova(fit)\nanova(fit)[[\"Mean Sq\"]] \n\n\n\n\n# Calculate Relative Importance for Each Predictor\nlibrary(relaimpo)\ncalc.relimp(fit,type=c(\"lmg\",\"last\",\"first\"),\n            rela=TRUE)\n\n# Bootstrap Measures of Relative Importance (1000 samples) \nboot <- boot.relimp(fit, b = 1000, type = c(\"lmg\", \n                                            \"last\", \"first\"), rank = TRUE, \n                    diff = TRUE, rela = TRUE)\nbooteval.relimp(boot) # print result\nplot(booteval.relimp(boot,sort=TRUE)) # plot result\n\n\n####\n# Look at all variables\n####\n\nb2011$log_salary <- log(b2011$salary)\n\nteams <- ddply(b2011,.(b2011$teamID), summarize, tot_salary=sum(salary))\n\n\nb2011$team_group <- \n\n\nfit <- lm(log_salary ~ birthCountry + weight + height + bats + throws + teamID + G + G_batting + AB + R + H + X2B + X3B + HR + RBI + SB + CS + BB + SO + IBB + HBP + SH + SF ,b2011)\n\nlibrary(MASS)\nstep <- stepAIC(fit, direction=\"both\")\nstep$anova # display results\n\n\n\n# Optimized Best Fit\n\nfit <- lm(salary ~ weight + height  + G + AB + R + H + X3B + RBI + CS + +BB + SO,b2011)\nsummary(fit)\nanova(fit)\nanova(fit)[[\"Mean Sq\"]] \n\n\nb2012_csv$predicted <- predict(fit,test_X)\n\n\n\n\n\n# Pricipal Components Analysis\n# entering raw data and extracting PCs \n# from the correlation matrix \nprincom <- princomp(b2011[c('weight', 'height'  , 'G' , 'AB' , 'R' , 'H' , 'X2B' , 'X3B' , 'HR' , 'RBI' , 'CS' , 'SO' , 'IBB')], cor=TRUE)\nsummary(princom) # print variance accounted for \nloadings(princom) # pc loadings \nplot(princom,type=\"lines\") # scree plot \nprincom$scores # the principal components\nbiplot(princom)\n\nplot(princom)\nbarplot(princom$sdev/princom$sdev[1])\n\nprincom <- princomp(b2011[c('weight', 'height'  , 'G' , 'AB' , 'R' , 'H' , 'X2B' , 'X3B' , 'HR' , 'RBI' , 'CS' , 'SO' , 'IBB')], tol=.1,cor=TRUE)\nsummary(princom)\n\nplot(princom$x)\n\n\n# Determine Number of Factors to Extract\nlibrary(nFactors)\nev <- eigen(cor(mydata)) # get eigenvalues\nap <- parallel(subject=nrow(mydata),var=ncol(mydata),\n               rep=100,cent=.05)\nnS <- nScree(x=ev$values, aparallel=ap$eigen$qevpea)\nplotnScree(nS)",
    "created" : 1382403694086.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1475347440",
    "id" : "87CE0AD3",
    "lastKnownWriteTime" : 1382481708,
    "path" : "~/Dropbox/Development/GA/R Projects/Baseball Salary/updated salary script.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_source"
}